{% extends 'base.html' %}

{% load static %}

{% load crispy_forms_tags %}

{% block title %}
{{ chapter.title }}
{% endblock %}

{% block content %}

<section class="container-fluid">
    <div class="col-12">
        <h1>{{ chapter.title }}</h1>
        {% if chapter.subtitle %}
        <h2>{{ chapter.subtitle }}</h2>
        {% endif %}
        <div class="row">
            <span>Started on: {{ chapter.created_on }}</span>
            <span>Last updated: {{ chapter.edited_on }}</span>
        </div>
    </div>
</section>
<section class="container-fluid">
    <div class="row">
        {% if notes %}
        <div class="col-md-9">
            <p>
                {{ chapter.content|linebreaks }}
            </p>
        </div>
        <div class="col-md-3">
            {% for note in notes %}
            <div>
                <p>
                    {{ note.content|linebreaks }}
                </p>
                <span>{{ note.created_on }}</span>
                <a href="{% url 'edit_note' note_id=note.id %}">Edit Note</a>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="col-md-9">
            <p>
                {{ chapter.content|linebreaks }}
            </p>
        </div>
        {% endif %}
    </div>
</section>
<section class="row">
    <div class="col-6">
        {% if user.is_authenticated %}
        <a href="{% url 'add_chapter' slug=chapter.book.slug %}">New Chapter</a>
        <a href="{% url 'edit_chapter' slug=chapter.slug %}">Edit Chapter</a>
        <a href="{% url 'add_note' slug=chapter.slug %}">Add Note</a>
        {% endif %}
    </div>
    <div class="col-4">
        <p>Wordcount: {{ chapter.content|wordcount }}</p>
    </div>
</section>


{% endblock %}